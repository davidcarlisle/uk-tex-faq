<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Master and slave counters</title>
<link rel="stylesheet" href="faq.css">
</head>
<body>
<div class="breadcrumbs">
<a href="index.html">FAQ</a> &gt; <a href="index.html#Macroprogramming">Macro programming</a> &gt; <a href="index.html#LaTeXmacroprogramming">LaTeX macro programming</a> &gt; <a href="index.html#Q-addtoreset">Master and slave counters</a>
</div>
<h1>Master and slave counters</h1>


<p>

<p>
It&rsquo;s common to have things numbered &ldquo;per chapter&rdquo; (for example, in
the standard <i class="class">book</i> and <i class="class">report</i> classes, figures, tables
and footnotes are all numbered thus).  The process of resetting is
done automatically, when the &ldquo;master&rdquo; counter is stepped (when the
<code>&#x5c;chapter</code> command that starts chapter &lsaquo;<i>n</i>&rsaquo; happens, the
<tt>chapter</tt> counter is stepped, and all the dependent counters are set
to zero).

<p>
How would you do that for yourself?  You might want to number
algorithms per section, or corollaries per theorem, for example.  If
you&rsquo;re defining these things by hand, you declare the relationship
when you define the counter in the first place:
<blockquote>
<code>&#x5c;newcounter</code><code>&#x7b;new-name&#x7d;</code>[master]
</blockquote>
says that every time counter &lsaquo;<i>master</i>&rsaquo; is stepped, counter
&lsaquo;<i>new-name</i>&rsaquo; will be reset.

<p>
But what if you have an uncooperative package, that defines the
objects for you, but doesn&rsquo;t provide a programmer interface to make
the counters behave as you want?

<p>
The <code>&#x5c;newcounter</code> command uses a LaTeX internal command, and you
can also use it:
<blockquote>
<code>&#x5c;@addtoreset</code><code>&#x7b;new-name&#x7d;</code></code><code>&#x7b;master&#x7d;</code>
</blockquote>
(but remember that it needs to be between <code>&#x5c;makeatletter</code> and
<code>&#x5c;makeatother</code>, or in a package of your own).

<p>
The <i class="package">chngcntr</i> package encapsulates the <code>&#x5c;@addtoreset</code>
command into a command <code>&#x5c;counterwithin</code>.  So:
<blockquote>
<pre>
\counterwithin*{corrollary}{theorem}
</pre>
</blockquote>
will make the corollary counter slave to theorem counters.  The
command without its asterisk:
<blockquote>
<pre>
\counterwithin{corrollary}{theorem}
</pre>
</blockquote>
will do the same, and also redefine <code>&#x5c;thecorollary</code> as 
&lsaquo;<i>theorem number</i>&rsaquo;.&lsaquo;<i>corollary number</i>&rsaquo;, which is a good scheme
if you ever want to refer to the corollaries&nbsp;&mdash; there are potentially
many &ldquo;corollary&nbsp;1&rdquo; in any document, so it&rsquo;s as well to tie its number
to the counter of the theorem it belongs to.  This is true of pretty
much any such counter-within-another; if you&rsquo;re not using the
<i class="package">chngcntr</i>, refer to the answer to 
<a href="FAQ-the-commands.html">redefining counters&rsquo; <code>&#x5c;the-</code>commands</a> for
the necessary techniques.

<p>
Note that the technique doesn&rsquo;t work if the master counter is <code class="verb">page</code>,
the number of the current page.  The <code class="verb">page</code> counter is stepped deep
inside the output routine, which usually gets called some time after
the text for the new page has started to appear: so special
techniques are required to deal with that.  One special case is dealt
with elsewhere: <a href="FAQ-footnpp.html">footnotes numbered per page</a>.  One
of the techniques described there, using package <i class="package">perpage</i>,
may be applied to any counter.  The command:
<blockquote>
<code>&#x5c;MakePerPage</code><code>&#x7b;counter&#x7d;</code>
</blockquote>
will cause &lsaquo;<i>counter</i>&rsaquo; to be reset for each page.  The package uses
a label-like mechanism, and may require more than one run of LaTeX
to stabilise counter values&nbsp;&mdash; LaTeX will generate the usual
warnings about labels changing.
<dl>
<dt class="ctanref">chngcntr.sty</dt><dd><a class="ctan" href="https://www.ctan.org/pkg/chngcntr">chngcntr</a>
<dt class="ctanref">perpage.sty</dt><dd>Distributed as part <a class="ctan" href="https://www.ctan.org/pkg/perpage">bigfoot</a>
</dl>

<p>

<hr><p class="faqlink">This question on the Web: <a href="http://www.tex.ac.uk/cgi-bin/texfaq2html?label=addtoreset">http://www.tex.ac.uk/cgi-bin/texfaq2html?label=addtoreset</a></p>
